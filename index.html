<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="script.js"></script>
  </head>
  <body>
    <!-- Top Bar -->
    <div class="w3-top w3-cell-row w3-area-blue">
      <div class="w3-container w3-area-blue w3-cell w3-center w3-xlarge w3-padding-16 w3-text-white">
        <a>Referral Suite</a>
      </div>
    </div>
    <div style="height: 80px;"></div>

    <!-- Progress bars -->
    <div class="w3-border-bottom">
      <table style="width: 100%;">
        <tr>
          <td style="width: 80%; padding-left: 10px;">
            <div class="w3-light-gray w3-round-medium">
              <div id="totReferralsBar" class="w3-red w3-round-medium" style="height: 24px; width: 0;"></div>
            </div>
          </td>
          <td id="totReferrals" class="w3-center w3-large" style="width: 20px; padding-left: 10px; padding-right: 10px;"></td>
        </tr>
      </table>
      <div class="w3-opacity" style="padding-left: 12px; padding-bottom: 5px">Claimed referrals</div>
    </div>

    <div class="w3-border-bottom" style="padding-top: 10px">
      <table style="width: 100%;">
        <tr>
          <td style="width: 80%; padding-left: 10px;">
            <div class="w3-light-gray w3-round-medium">
              <div id="oldReferralBar" class="w3-red w3-round-medium" style="height: 24px; width: 0;"></div>
            </div>
          </td>
          <td id="agebyday" class="w3-center w3-large" style="width: 20px; padding-left: 10px; padding-right: 10px;"></td>
        </tr>
      </table>
      <div class="w3-opacity" style="padding-left: 12px; padding-bottom: 5px">Oldest referral age (days)</div>
    </div>
    
    <div class="w3-center w3-xlarge" style="margin-top: 15px;">Welcome to Referral Suite!</div>
    <div class="w3-large" style="padding-top: 10px; padding-left: 10px">Here is a list of things to check (in order) during your inbox shift!</div>
    <div class="w3-border-bottom">
      <table>
        <tr class="spaceUnder">
          <td>
            <img src="ABP.png" height="30px" class="w3-round w3-icon-shadow" style="margin-left: 10px; margin-right: 5px">
          </td>
          <td>
            <div>Contact all unclaimed referrals through the SMOEs Area Book</div>
          </td>
        </tr>
        <tr class="spaceUnder">
          <td>
            <div class="w3-light-gray w3-xlarge w3-round w3-icon-shadow" style="margin-left: 10px; margin-right: 5px">
              <i class="fa fa-bell w3-center" style="padding-left: 3px"></i>
            </div>
          </td>
          <td>
            <div>Claim the same people through this app</div>
          </td>
        </tr>
        <tr class="spaceUnder">
          <td>
            <img src="Business_Suite.png" height="30px" class="w3-round w3-icon-shadow" style="margin-left: 10px; margin-right: 5px;">
          </td>
          <td>
            <div>Check Business Suite, respond to any new messages</div>
          </td>
        </tr>
        <tr class="spaceUnder">
          <td>
            <div class="w3-light-gray w3-xlarge w3-round w3-icon-shadow" style="margin-left: 10px; margin-right: 5px">
              <i class="fa fa-address-book w3-center" style="padding-left: 3px"></i>
          </td>
          <td>
            <div>Contact anyone you have already claimed</div>
          </td>
        </tr>
        <tr class="spaceUnder">
          <td>
            <img src="Business_Suite.png" height="30px" class="w3-round w3-icon-shadow" style="margin-left: 10px; margin-right: 5px;">
          </td>
          <td>
            <div>Respond to the comments on Busines Suite</div>
          </td>
        </tr>
      </table>
    </div>

    <div class="w3-center w3-xlarge" style="margin-top: 15px;">Usefull Links</div>
    <ul class="w3-large">
      <li><a class="uline" href="#">FAQs for This App</a></li>
      <li><a class="uline" href="#">FAQs for Business Suite</a></li>
      <li><a class="uline" href="#">Something Else</a></li>
    </ul>

    <!-- Sign Out Button -->
    <div class="">
      <button onclick="doubleCheckSignOut(this)" href="login.html" class="w3-button w3-blue w3-xlarge w3-round-large" style="margin-left:10px; margin-top: 50px;">
        Sign Out
      </button>
    </div>


    <!-- Bottom Nav Bar -->
    <div style="height: 80px;"></div>
    <div class="w3-bottom w3-cell-row w3-light-gray w3-padding-16">

      <div class="w3-container w3-cell w3-center w3-xlarge">
        <a href="index.html">
          <i class="fa fa-home"></i>
          <div class="w3-tiny w3-opacity" style="height: 0;">Home</div>
        </a>
      </div>

      <div class="w3-container w3-cell w3-center w3-xlarge">
        <a href="schedule.html">
          <i class="fa fa-calendar-o"></i>
          <div class="w3-tiny w3-opacity" style="height: 0;">Schedule</div>
        </a>
      </div>

      <div class="w3-container w3-cell w3-center w3-xlarge">
        <a href="contact_book.html">
          <i class="fa fa-address-book"></i>
          <div class="w3-tiny w3-opacity" style="height: 0;">Referrals</div>
        </a>
      </div>

      <div class="w3-container w3-cell w3-center w3-xlarge">
        <a href="unclaimed_referrals.html">
          <i class="fa fa-bell w3-text-area-blue"></i>
          <div class="w3-tiny w3-opacity" style="height: 0;">Unclaimed</div>
        </a>
        <div style="height: 0; width: 100%;">
          <div id="reddot" class="w3-circle w3-red w3-notification-dot" style="display: none;"></div>
        </div>
      </div>

      <div class="w3-container w3-cell w3-center w3-xlarge">
        <a href="sync.html">
          <i class="fa fa-refresh"></i>
          <div class="w3-tiny w3-opacity" style="height: 0;">Sync</div>
        </a>
      </div>

    </div>


    <script>

let maxRefsAllowed = 10;
const currentRefCount = data.area_specific_data.my_referrals.length;


let totReferralsBar = document.getElementById("totReferralsBar");
let totReferrals = document.getElementById("totReferrals");

totReferralsBar.style.width = Math.min(currentRefCount / maxRefsAllowed * 100, 100) + '%';

totReferrals.innerHTML = currentRefCount + '/' + maxRefsAllowed;

if (currentRefCount >= maxRefsAllowed) {
  totReferrals.style.color = "red";
}

let maxRefAge = 10;
let oldReferralBar = document.getElementById("oldReferralBar");
let agebyday = document.getElementById("agebyday");
let oldReferral = data.area_specific_data.my_referrals[currentRefCount-1][1];
let today = new Date();
let oldDate = new Date(oldReferral);
let dayDifference = Math.round((today.getTime()-oldDate.getTime()) / (1000 * 60 * 60 * 24));
oldReferralBar.style.width = Math.min(dayDifference / maxRefAge * 100, 100) + '%';

agebyday.innerHTML = dayDifference + '/' + maxRefAge;

if (dayDifference >= maxRefAge) {
  agebyday.style.color = "red";
}
    </script>
    
  </body>
</html>
